<div>
  <h2 class="h5">New Partner</h2>
  <form id="form" class="mt-3">
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">Name</label>
        <input class="form-control" name="name" required>
      </div>
      <div class="col-md-3">
        <label class="form-label">Type</label>
        <select class="form-select" name="type">
          <option value="COMPANY">Company</option>
          <option value="INDIVIDUAL">Individual</option>
        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">Status</label>
        <select class="form-select" name="status">
          <option value="ACTIVE">Active</option>
          <option value="INACTIVE">Inactive</option>
        </select>
      </div>
      <div class="col-md-12">
        <label class="form-label">Roles</label>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" name="is_customer" id="is_customer">
          <label class="form-check-label" for="is_customer">Customer</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" name="is_vendor" id="is_vendor">
          <label class="form-check-label" for="is_vendor">Vendor</label>
        </div>
      </div>
      <div class="col-md-6">
        <label class="form-label">Email</label>
        <input type="email" class="form-control" name="email">
      </div>
      <div class="col-md-6">
        <label class="form-label">Phone</label>
        <input class="form-control" name="phone">
      </div>
    </div>
    <div class="mt-3 d-flex gap-2">
      <button class="btn btn-primary" type="submit">Create</button>
      <a class="btn btn-outline-secondary" href="/app/partners">Cancel</a>
    </div>
  </form>
</div>
<script>
  (function(){
    const form = document.getElementById('form');
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const token = localStorage.getItem('accessToken');
      const fd = new FormData(form);
      const payload = Object.fromEntries(fd.entries());
      payload.is_customer = !!fd.get('is_customer');
      payload.is_vendor = !!fd.get('is_vendor');
      const res = await fetch('/api/partners/partners/', {
        method: 'POST',
        headers: { 'Content-Type':'application/json', 'Authorization': `Bearer ${token}` },
        body: JSON.stringify(payload)
      });
      if(!res.ok){ notify('Failed to create partner', 'error'); return; }
      const obj = await res.json();
      window.location = `/app/partners/${obj.id}`;
    });
  })();
</script>
